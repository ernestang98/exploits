### CVE-2023-33693

There is a SEH overflow vulnerability caused by using unsafe strcpy() function in xmlconfig.cpp file in the LoadConfig() function which loads the URL parameter from config file EasyPlayerPro.xml and may result in a SEH/Stack Buffer Overflow. A simple fix to this is to replace strcpy() with strncpy() and set a fix length for the URL field at 256. This ensures that tsingsee/EasyPlayerPro all versions v3.2.19.0106 and v3.6.19.0823 is not vulnerable to a SEH overflow, mainly caused by the usage of unsafe strcpy() function in xmlconfig.cpp file LoadConfig() function, where strcpy() is used to copy over the user controlled URL field in EasyPlayerPro.xml.

### Notes

The script found here only results in DOS and eip control (0x41414141). I lost the exploit which managed to pop a calculator bypassing stack cookie, SafeSEH, DEP, and ASLR lmao but I will roughly share how I did it:

- Stack Cookie: trigger SEH

- SafeSEH: use a SafeSEH-disabled but ASLR-enabled module

- ASLR: bruteforce (rofl), I think if we managed to find a SafeSEH-disabled and ASLR-disabled module with a suitable gadget to stack pivot into our overflowed SEH buffer, we won't need to bypass ASLR but if I remember correctly, no such gadget/module was available (or maybe I was/am just a n00b)

- DEP: Stack Pivot + ROP

### PoC/Demo

[Video 1](https://www.youtube.com/watch?v=K27nGHa-hTE&feature=youtu.be&ab_channel=ErnestAng), [Video 2](https://www.youtube.com/watch?v=JkIhyO_z3VU&feature=youtu.be)