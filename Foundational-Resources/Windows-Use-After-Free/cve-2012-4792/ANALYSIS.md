# Disassembly

```
6c19e1cb 8b07            mov     eax,dword ptr [edi]
6c19e1cd 57              push    edi
6c19e1ce 8975c4          mov     dword ptr [ebp-3Ch],esi
6c19e1d1 8975d4          mov     dword ptr [ebp-2Ch],esi
6c19e1d4 8975dc          mov     dword ptr [ebp-24h],esi
6c19e1d7 8975d8          mov     dword ptr [ebp-28h],esi
6c19e1da 8975e0          mov     dword ptr [ebp-20h],esi
6c19e1dd 8975e4          mov     dword ptr [ebp-1Ch],esi
6c19e1e0 ff90dc000000    call    dword ptr [eax+0DCh]

(ebc.648): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
eax=f0f0f0f0 ebx=064db470 ecx=00000052 edx=00000000 esi=00000000 edi=004cc880
eip=6c19e1e0 esp=036ad43c ebp=036ad494 iopl=0         nv up ei pl nz na po nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010202
*** ERROR: Symbol file could not be found.  Defaulted to export symbols for C:\Windows\System32\mshtml.dll - 
mshtml!Ordinal104+0x3dc41:
6c19e1e0 ff90dc000000    call    dword ptr [eax+0DCh] ds:0023:f0f0f1cc=????????

0:005> dd edi
00423fb0  f0f0f0f0 f0f0f0f0 f0f0f0f0 f0f0f0f0
00423fc0  f0f0f0f0 f0f0f0f0 f0f0f0f0 f0f0f0f0
00423fd0  f0f0f0f0 f0f0f0f0 f0f0f0f0 f0f0f0f0
00423fe0  f0f0f0f0 f0f0f0f0 f0f0f0f0 f0f0f0f0
00423ff0  f0f0f0f0 f0f0f0f0 f0f0f0f0 f0f0f0f0
00424000  f0f0f0f0 f0f0f0f0 a0a0a0a0 a0a0a0a0
00424010  00000000 00000000 03b8dba7 0000578c
00424020  0047ee90 0048a188 f0f0f0f0 a0a0f0f0
```

- `!heap -p -a edi` will give 0x58

- Page heap is enabled 

- If we attempt to fill the space and thereby control EIP, we will fail (`!heap -p -a edi` will give whack values)

- If page heap is disabled and we attempt to fill the space and thereby control eip, we are successful (see exploit.html)

- Once you have confirmed the size allocation, you MUST disable page heap during exploitation